@using Microsoft.AspNetCore.Identity
@using QuanLyLopHoc.Areas.Identity.Data
@using QuanLyLopHoc.Services
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject IUserService UserService
@{
    var userId = UserManager.GetUserId(User);
    var user = await UserService.GetUserbyId(userId);
}

@if (SignInManager.IsSignedIn(User))
{
    @if (user == null)
    {
        <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Logout"
      asp-route-returnUrl="@Url.Action(" Index", "Home" , new { area="" })">
            <button id="logout" type="submit" class="nav-link btn btn-link text-dark">Logout</button>
        </form>
    }
    else if (@user.Avatar == null)
    {
         <a href="#" class="group flex items-center space-x-4 rounded-md px-4 py-3 text-gray-600">
            <div id="alter-avatar" class="bg-gray-700 rounded-full h-5 w-5 inline-flex justify-center items-center">
                <span class="font-bold text-sm text-white ">@user.LastName.Split(' ').Last()[0]</span>
            </div>
            <img id="avatar" class="hidden rounded-full w-5 h-5" src="" alt="image description">
            <span class="group-hover:text-gray-700">@user.FirstName @user.LastName</span>
        </a>
        <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Logout"
      asp-route-returnUrl="@Url.Action(" Index", "Home" , new { area="" })">
            <button id="logout" type="submit" class="nav-link btn btn-link text-dark">Logout</button>
        </form>
    }
    else
    {
        <a href="#" class="group flex items-center space-x-4 rounded-md px-4 py-3 text-gray-600">
            <div id="alter-avatar"
                 class="hidden bg-gray-700 rounded-full h-5 w-5 inline-flex justify-center items-center">
                <span class="font-bold text-6xl text-white ">@user.LastName.Split(' ').Last()[0]</span>
            </div>
            <img id="avatar" class="rounded-full w-5 h-5" src="@user.Avatar" alt="image description">
            <span class="group-hover:text-gray-700">@user.FirstName @user.LastName</span>
        </a>
        <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Logout"
      asp-route-returnUrl="@Url.Action(" Index", "Home" , new { area="" })">
            <button id="logout" type="submit" class="nav-link btn btn-link text-dark">Logout</button>
        </form>
    }
    @*<li class="nav-item">
            <a id="manage" class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index"
                title="Manage">Hello @UserManager.GetUserName(User)!</a>
        </li>
        <li class="nav-item">
            <form id="logoutForm" class="form-inline" asp-area="Identity" asp-page="/Logout"
                asp-route-returnUrl="@Url.Action(" Index", "Home" , new { area="" })">
                <button id="logout" type="submit" class="nav-link btn btn-link text-dark">Logout</button>
            </form>
        </li>*@
}
else
{
    <a href="#" class="group flex items-center space-x-4 rounded-md px-4 py-3 text-gray-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 group-hover:fill-cyan-600" viewBox="0 0 20 20"
             fill="currentColor">
            <path fill-rule="evenodd"
                  d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"
                  clip-rule="evenodd" />
        </svg>
        <span class="group-hover:text-gray-700">Settings</span>
    </a>
}